<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="bitkarrot" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>How-To guides - Pylnbits Docs</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "How-To guides";
        var mkdocs_page_input_path = "how-to-guides.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/python.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Pylnbits Docs
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Pylnbits Docs</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">How-To guides</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#getting-started">Getting Started</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#install-from-source">Install from source</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#release-note">Release Note</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#resolved-bugs">Resolved Bugs</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#pypi-release">PyPi release</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#set-up-your-config">Set up your Config</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#configyml">config.yml</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#example-code">Example Code</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#sample-code-for-user-wallet">Sample code for User Wallet</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#where-to-get-lnbits-api-details">Where to get LNBits API details</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#sample-code-for-lnurlp">Sample code for LNURLp</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#more-examples">More Examples</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../reference/">Reference</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../explanation/">Explanation</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Pylnbits Docs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>How-To guides</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/lightningames/pylnbits/blob/main/docs/how-to-guides.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="how-to-guides">How To Guides</h1>
<p>This is a brief guide on how to use the pylnbits library. First create an an account on your LNBits instance by visiting the main page and naming your wallet. Be sure to bookmark the link to be able to get access in the future. If you are not familiar with LNBits, please take the time to familiarize yourself with how user accounts work and how invoices are created and paid on LNBits first.</p>
<p>Next, click on <code>enable extensions</code> in the side navigation bar on your LNBits account. Enable the extensions that you want to use. Extension use is <em>optional</em>, and is not required for generating invoices or receiving payments. The <strong>pylnbits</strong> library currently only supports the following extensions from <a href="https://lnbits.com">LNBits</a>:</p>
<ul>
<li>User Wallet (not an extension, created initially)</li>
<li>Invoices</li>
<li>User Manager</li>
<li>LNURLp</li>
<li>LNURLw</li>
<li>LndHub</li>
</ul>
<h2 id="getting-started">Getting Started</h2>
<p>Use version at least <strong>python3.8</strong></p>
<h3 id="install-from-source">Install from source</h3>
<pre><code>git clone https://github.com/lightningames/pylnbits
cd pylnbits
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
pip install -e .
</code></pre>
<h3 id="release-note">Release Note</h3>
<p>Current pylnbits release is <strong>0.0.8</strong></p>
<h6 id="resolved-bugs">Resolved Bugs</h6>
<ul>
<li>UnboundLocalError when config_file is None</li>
<li>/api/v1/payments/decode expects the body as json</li>
<li>get_url returns the dict after extracting the json attribute therefore this fails in the UserWallet class.</li>
</ul>
<h3 id="pypi-release">PyPi release</h3>
<p><a href="https://pypi.org/project/pylnbits/">https://pypi.org/project/pylnbits/</a></p>
<pre><code>pip install pylnbits
</code></pre>
<h2 id="set-up-your-config">Set up your Config</h2>
<p>In your LNBits account, click on the API info tab. You should see <strong>Wallet ID, Admin Key and Invoice/read key</strong>.</p>
<p><img alt="LNBits user dashboard" src="../images/lnbits.png" /></p>
<p>First create a <code>config.yml</code> file, copy the Keys from LNBits with your values. There is a sample <code>config_sample.yml</code> file in the pylnbits source directory.</p>
<h3 id="configyml"><code>config.yml</code></h3>
<pre><code>lnbits_url: &quot;https://&lt;your lnbits domain here, e.g. https://legend.lnbits.com&gt;&quot;

# get api_keys from LNbits Wallet

in_key: &quot;&lt;your Invoice Key here&gt;&quot;
admin_key: &quot;&lt; Your Admin Key here&gt;&quot;
</code></pre>
<h2 id="example-code">Example Code</h2>
<h3 id="sample-code-for-user-wallet">Sample code for User Wallet</h3>
<p>The following is sample code that uses config.yml in your current directory for calling methods from the user wallet.</p>
<p>This Example code runs test for the following:</p>
<ul>
<li>INITIALIZE the pylnbits with your config file</li>
<li>GET wallet details</li>
<li>CHECK an invoice payment hash</li>
<li>CREATE an invoice</li>
<li>PAY an invoice (Bolt11)</li>
</ul>
<p>Replace the sample data with your data, e.g. bolt and payment_hash variables</p>
<pre><code>import asyncio

from aiohttp.client import ClientSession

from pylnbits.config import Config
from pylnbits.user_wallet import UserWallet

async def main():

    # INITIALIZE the pylnbits with your config file
    c = Config(config_file=&quot;config.yml&quot;)
    url = c.lnbits_url
    print(f&quot;url: {url}&quot;)
    print(f&quot;headers: {c.headers()}&quot;)
    print(f&quot;admin_headers: {c.admin_headers()}&quot;)


    async with ClientSession() as session:
        # GET wallet details
        uw = UserWallet(c, session)
        userwallet = await uw.get_wallet_details()
        print(f&quot;user wallet info : {userwallet}&quot;)

        # CHECK an invoice payment hash
        payment_hash = &quot;edefef3766537446c70e51af9b414fb3b319baf515f1ff9852c0289eae3665a1&quot;
        res = await uw.check_invoice(payment_hash)
        print(f&quot;check invoice response: {res}&quot;)

        # CREATE an invoice
        res = await uw.create_invoice(False, 150, &quot;testcreatetwo&quot;, &quot;http://google.com&quot;)
        print(f'\nCreate invoice RESPONSE: {res}\n\n')

        # PAY an invoice - add balance and check
        # replace the bolt below with your bolt11
        bolt = &quot;lnbc800n1ps23r2dpp5ahh77dmx2d6yd3cw2xheks20kwe3nwh4zhcllxzjcq5fat3kvkssdqsd9h8vmmfvdjk7mn9cqzpgrzjq02snzwz4petaly54yzjkm358rqa5as9hkgydjvxxmvlpuk6dfd9cz0y2cqq0qsqqyqqqqlgqqqqqqgq9qsp5cut63ftfcffwkrr2w9r50w5e40m93k3er75mc70ysxps7yercs9s9qyyssqs7qk3cz97nm5m6ehzedcxhttx87l7x5kk38gvwkzzv4lhrhddtqq3sk43nnvsddagf36ledw9vhlpqxuu5s53pj6sz926mwqxf8chsgp2m9j8w&quot;  # noqa
        body = {&quot;out&quot;: True, &quot;bolt11&quot;: bolt}
        res = await uw.pay_invoice(True, bolt)
        print(res)


loop = asyncio.get_event_loop()
loop.run_until_complete(main())

</code></pre>
<h3 id="where-to-get-lnbits-api-details">Where to get LNBits API details</h3>
<p>For more details on what values need to be passed to the above pylnbits example, please check the LNBits API docs, which should be located on the LNBits website in the section below your the Admin and Invoice Key. Expand the tabs as shown in the image below.</p>
<p><img alt="API detail" src="images/api_info.png" /></p>
<h3 id="sample-code-for-lnurlp">Sample code for LNURLp</h3>
<p>The following is sample code that uses config.yml in your current directory for calling methods from the LNURLp extension</p>
<pre><code># test lnurlp pay link
import asyncio

from aiohttp.client import ClientSession

from pylnbits.config import Config
from pylnbits.lnurl_p import LnurlPay

# Example code for testing LNURLp

async def main():
    c = Config(config_file=&quot;config.yml&quot;)
    url = c.lnbits_url
    print(f&quot;url: {url}&quot;)
    print(f&quot;headers: {c.headers()}&quot;)
    print(f&quot;admin_headers: {c.admin_headers()}&quot;)

    async with ClientSession() as session:
        lw = LnurlPay(c, session)

        # list links
        links = await lw.list_paylinks()
        print(&quot;list all links: &quot; , str(links), &quot;\n\n&quot;)

        # get pay link
        pay_id = links[0]['id']
        print(f'pay_id for get_link: {pay_id}')
        getlink = await lw.get_paylink(pay_id=str(pay_id))
        print(&quot;get pay link: &quot;, str(getlink), &quot;\n&quot;)

        # create pay link
        body = {&quot;description&quot;: &quot;auto pay link&quot;,
                &quot;amount&quot;: 100,
                &quot;max&quot;: 10000,
                &quot;min&quot;: 100,
                &quot;comment_chars&quot;: 100}

        newlink = await lw.create_paylink(body=body)
        print(f&quot;create pay link with body: {body}, result link: {newlink} \n&quot;)
        pay_id = newlink['id']

        # update newly created link above
        # all body fields are required
        body = {&quot;description&quot;: &quot;update auto paylink&quot;,
                &quot;amount&quot;: 150,
                &quot;max&quot;: 10000,
                &quot;min&quot;: 100,
                &quot;comment_chars&quot;: 100}
        update_result = await lw.update_paylink(pay_id=str(pay_id), body=body)
        print(f'update pay link with intial id: {pay_id}, body: {body} \n result: {update_result}\n\n')

        # delete above created link
        delete_result = await lw.delete_paylink(pay_id=str(pay_id))
        print(f'delete pay link id: {pay_id}, result: {delete_result}\n\n')


loop = asyncio.get_event_loop()
loop.run_until_complete(main())

</code></pre>
<h2 id="more-examples">More Examples</h2>
<p>More example code can be found in the <strong>tests</strong> directory as shown in the <a href="/pylnbits/#project-layout">Project Layout</a> section.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href=".." class="btn btn-neutral float-left" title="Pylnbits Docs"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../reference/" class="btn btn-neutral float-right" title="Reference">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/lightningames/pylnbits" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href=".." style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../reference/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
